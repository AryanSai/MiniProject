<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Book Builder</title>
    <style>
        .highlight {
            background-color: yellow;
        }
    </style>
</head>

<body>
    <br>
    <div class="page" data-audio="audio/page1.mp3">
        <img id="slide_image" src="" alt="Page Image">
        <p id="text-container"></p>
        <div class="button-audio-container">
            <button onclick="prevPage()">Previous</button>
            <div>
                <audio controls id="audioPlayer">
                    Your browser does not support the audio element.
                </audio>
            </div>
            <button onclick="nextPage()">Next</button>
        </div>
    </div>


    <script>
        const textArray = [
            "On a bright spring morning, Collette and Jimmy went to the zoo.",
            '"Collette, what animals do you want to see today at the zoo?" asked Jimmy.  "I want to see the jaguars" , answered Collette.',
            '"Cool!" said Jimmy. "Let\'s go."',
        ];

        let currentPageIndex = 0;

        function updatePageContent() {
            const textContainer = document.getElementById('text-container');
            const audioPlayer = document.getElementById('audioPlayer');
            const words = textArray[currentPageIndex].split(' ');

            // Clear previous content and remove highlights
            textContainer.innerHTML = '';
            words.forEach(word => {
                const span = document.createElement('span');
                span.textContent = word + ' ';
                textContainer.appendChild(span);
            });

            // Update image and audio
            document.getElementById('slide_image').src = `Images/${currentPageIndex + 1}.jpg`;
            audioPlayer.src = `Audio/${currentPageIndex + 1}.mp3`;

            // Highlight the first word initially
            highlightWord(0);

            // Listen for the 'timeupdate' event to track the current time of the audio
            audioPlayer.addEventListener('timeupdate', function () {
                // Calculate the current word being spoken based on the audio currentTime
                const currentTime = audioPlayer.currentTime;
                const currentWordIndex = Math.floor(currentTime / (audioPlayer.duration / words.length));

                // Highlight the current word
                highlightWord(currentWordIndex);
            });
        }

        function highlightWord(wordIndex) {
            const words = document.getElementById('text-container').querySelectorAll('span');

            // Remove highlight from all words
            words.forEach(word => word.classList.remove('highlight'));

            // Add highlight to the current word
            words[wordIndex].classList.add('highlight');
        }

        function nextPage() {
            if (currentPageIndex < textArray.length - 1) {
                currentPageIndex++;
                updatePageContent();
            }
        }

        function prevPage() {
            if (currentPageIndex > 0) {
                currentPageIndex--;
                updatePageContent();
            }
        }

        // Call updatePageContent on page load
        window.onload = updatePageContent;
    </script>
</body>

</html>